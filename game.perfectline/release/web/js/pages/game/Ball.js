var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])};return function(s,o){function i(){this.constructor=s}t(s,o),s.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),Ball=function(t){function s(){var s=t.call(this)||this;return s._shadows=[],s._posArr=[],s._needAni=!1,s._maxNode=40,s.init(),s}return __extends(s,t),s.prototype.init=function(){this.$shadow=new Laya.Image,this.$shadow.anchorX=.5,this.$shadow.anchorY=.477,this.addChild(this.$shadow),this.$image=new Laya.Image,this.$image.anchorX=.5,this.$image.anchorY=.46,this.addChild(this.$image)},s.prototype.setSkin=function(t,s){var o=DBGame.roleInfo[t];if(this._roleData=o,o){this.$image.skin="res/ic_role/"+o.skin+".png",o.shadow?this.$shadow.skin="res/ic_role/"+o.shadow+".png":this.$shadow.skin="",this._needAni=o.rotate,this._roleData.rendFrame=s<=.3?10:s<.5?8:6,this._maxNode=o.rendFrame*(this._shadows.length+2)-3;for(var i=0;i<this._shadows.length;i++)this._shadows[i].skin=this.$image.skin}this._needAni&&this.play()},s.prototype.reset=function(){for(var t=0;t<this._shadows.length;t++)this._shadows[t].visible=!1;this._posArr.length=0},s.prototype.play=function(){this.frameLoop(2,this,this.onPlay)},s.prototype.stop=function(){this.clearTimer(this,this.onPlay)},s.prototype.onPlay=function(){this.$image.rotation+=s.ROTATE},s.prototype.flash=function(){Laya.timer.frameLoop(3,this,this.doFlash)},s.prototype.removeFlash=function(){this.alpha=1,Laya.timer.clear(this,this.doFlash)},s.prototype.doFlash=function(){1==this.alpha?this.alpha=.5:this.alpha=1},s.prototype.update=function(){for(this._posArr.push({x:Math.floor(this.x),y:Math.floor(this.y)});this._posArr.length>this._maxNode;)this._posArr.shift();for(var t,s,o=this._roleData.rendFrame;o<this._posArr.length;o++)this._posArr[o]&&(o-1)%this._roleData.rendFrame==0&&(t=(o-1)/this._roleData.rendFrame-1,(s=this._shadows[t])&&(s.visible=!0,s.pos(this._posArr[o].x,this._posArr[o].y),s.parent||this.parent.addChildAt(s,this.parent.getChildIndex(this))));for(o=t;o<this._shadows.length-1;o++)this._shadows[o].visible=!1},s.prototype.shadow=function(t){this._shadows.length=0,this._renderIndex=0,this._posArr.length=0;for(var s,o=0;o<t;o++)(s=new Laya.Image).anchorX=s.anchorY=.5,s.scale(.5,.5),this._shadows.push(s)},s.ROTATE=6,s}(Laya.Sprite);