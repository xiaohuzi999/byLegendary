var __extends=this&&this.__extends||function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var n in t)t.hasOwnProperty(n)&&(i[n]=t[n])};return function(t,n){function e(){this.constructor=t}i(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),hadShowSignView="hadShowSignView",SigninPop=function(i){function t(){var n=i.call(this)||this;n.ui=new ui.plugins.SignInUI,n.bgAlpha=.8,n.isTranslucent=!1,n.canceledOnTouchOutside=!1,n.visible=!t.autoFlag,n.ui.btnClose.on(Laya.Event.CLICK,n,function(){n.finish()}),n.ui.btnReceice.on(Laya.Event.CLICK,n,function(){var i=SigninManager.signIndex(),t=n.configList[i];SigninManager.sign(t),n.showAddCoinToast(t),n.ui.btnReceice.visible=!1});var e=n;return fetchSignList().then(function(i){if(i&&i.list){var t,n=i.list,a=n[n.length-1],o=a.rewards;t=DataManager.getData(HadRole)?2:3;var s=o.find(function(i){return i.type=t});a.type=t,a.target=s.target,e.configList=i.list,e.updateUI()}}),n}return __extends(t,i),t.show=function(i){void 0===i&&(i=!1),Tape.PopManager.showPop(t)},t.prototype.showAddCoinToast=function(i){SignResultView.show(i)},t.prototype.updateUI=function(i){var n=this;if(void 0===i&&(i=!1),this.ui){if(this.configList.forEach(function(i,t){var e=n.ui["sign"+(t+1)],a=i.type;e.rewardCountLabel.text="X"+i.target,e.dayLabel.text="第"+(t+1)+"天",1==a?(e.rewardImg.skin="res/signin/ic_power.png",e.tfType.text="体力"):2==a?(e.rewardImg.skin="res/signin/ic_coin.png",e.tfType.text="金币"):3==a&&(e.visible=!1,(e=n.ui.sign8).visible=!0)}),!SigninManager.checkSignBreak()){DataManager.getData(SignKey).forEach(function(i,t){if(3==i.type)n.ui.sevenRoleLabel.text="已领取";else{var e=n.ui["sign"+(t+1)];e.dayLabel.text="已领取",e.stateImg.visible=!0,e.stateImg.skin="res/signin/btn_choose.png"}})}SigninManager.hadSign()?(this.ui.btnReceice.visible=!1,t.autoFlag&&this.finish()):(this.ui.btnReceice.visible=!0,t.autoFlag&&(this.visible=!0)),t.autoFlag=!1}},t.prototype.onShow=function(){Laya.stage.on(refreshSign,this,this.updateUI)},t.prototype.onHide=function(){Laya.stage.off(refreshSign,this,this.updateUI)},t.autoFlag=!1,t}(xframe.XMWindow);