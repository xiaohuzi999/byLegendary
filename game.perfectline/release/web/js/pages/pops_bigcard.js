var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,a){e.__proto__=a}||function(e,a){for(var t in a)a.hasOwnProperty(t)&&(e[t]=a[t])};return function(a,t){function n(){this.constructor=a}e(a,t),a.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),BigCardView=function(e){function a(){var a=e.call(this)||this;return a.ui=new ui.views.PopBigCardUI,a.cardView=new ui.views.CardViewUI,a.shareMenu=new ui.views.ShareMenuUI,a.months=["JANUARY","FEBURARY","MARCH","APRIL","MAY","JUNE","JULY","AUGUST","SEPTEMBER","OCTOBER","NOVEMBER","DECEMBER"],a.bgAlpha=.8,a.ui.shareBtn.on(Laya.Event.CLICK,null,function(e){e.stopPropagation(),a.shareMenu.bottomView.y=1334,Laya.Tween.to(a.shareMenu.bottomView,{y:1038},300,Laya.Ease.linearInOut),a.ui.addChild(a.shareMenu),a.shareMenu.on(Laya.Event.CLICK,null,function(){e.stopPropagation(),a.clearShareMenu()}),a.shareMenu.wxBtn.on(Laya.Event.CLICK,null,function(){var e=User.instace.userInfo.avatarUrl,t=HelpUtil.shareByView(a.cardView,-30,-50,440,440),n=["《"+a.params.name+"》--"+a.params.author,"今日份的音乐心情"],i=Math.round(Math.random());yxmp.report.event("2000_2004_click");var r={title:n[i],imageUrl:t,entry:"2000_2004_click",material:["15350799111612","15350799122613"][i],query:"cover="+a.params.card+"&avatar="+e+"&id="+a.params.id+"&cid="+a.params.cid+"&time="+a.time},o=yxmp.plugin.help.getShareOptions(shareMuiscCard,r);wx.shareAppMessage(o)}),a.shareMenu.pyq.on(Laya.Event.CLICK,null,function(){yxmp.report.event("2000_2003_click");var e=HelpUtil.shareByView(a.cardView);wx.saveImageToPhotosAlbum({filePath:e,success:function(e){wx.showToast({icon:"none",title:"已保存至相册，记得去分享哦～"})},fail:function(e){wx.showToast({icon:"none",title:"保存失败, 点击右上角=>关于完美音轨=>设置=>保存到相册"})}})}),a.shareMenu.closeBtn.on(Laya.Event.CLICK,null,function(){console.log("关闭"),a.clearShareMenu()})}),a.ui.on(Laya.Event.CLICK,null,function(){a.finish()}),a}return __extends(a,e),a.prototype.onShow=function(){this.params&&this.params.card&&(this.cardView.bgImg.skin="https://s.xiuwu.me/perfectline/res/map/"+this.params.card+".png");var e=new Date;this.params.timeTemp&&(e=new Date(this.params.timeTemp)),this.time=e.getTime(),this.cardView.dateDay.text=e.getDate().toString(),this.cardView.dateMonth.text=this.months[e.getMonth()],this.cardView.dateYear.text=e.getFullYear().toString(),this.ui.bigImg.addChild(this.cardView);var a=GameDataManager.instance.cardConfig[this.params.cid];this.cardView.roleImg.skin=GameDataManager.instance.currentUserRoleImg(),this.cardView.roleImg.x=50*a[0]/75-4,this.cardView.roleImg.y=50*a[1]/75-4},a.prototype.clearShareMenu=function(){var e=this;Laya.Tween.to(this.shareMenu.bottomView,{y:1334},300,Laya.Ease.linearInOut,Laya.Handler.create(this,function(){e.shareMenu.removeSelf()}))},a}(xframe.XMWindow);