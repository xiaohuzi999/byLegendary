var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,a){t.__proto__=a}||function(t,a){for(var e in a)a.hasOwnProperty(e)&&(t[e]=a[e])};return function(a,e){function i(){this.constructor=a}t(a,e),a.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),GameResultView=function(t){function a(){var a=t.call(this)||this;return a.ui=new ui.views.GameResultViewUI,a.topToast=new ui.views.TopToastViewUI,a.init(),a}return __extends(a,t),a.prototype.init=function(){var t=this;this.ui.homebtn.on(Laya.Event.CLICK,null,function(){XEvent.instance.event(GameEvent.BACK),t.close()}),this.ui.restartbtn.on(Laya.Event.CLICK,null,function(a){a.stopPropagation(),XEvent.instance.event(GameEvent.RESTART),t.close()}),this.ui.nextBtn.on(Laya.Event.CLICK,null,function(){t.chooseNextMusic(),t.close()})},a.prototype.show=function(){for(var a=[],e=0;e<arguments.length;e++)a[e]=arguments[e];t.prototype.show.call(this),this.params=a[0]},a.prototype.onShow=function(){this._rewardCoin=GameDataManager.instance.rewardCoinByStar(this.params.star),this.updateUi(),User.instace.userInfo.coin+=this._rewardCoin},a.prototype.updateUi=function(){for(var t=1;t<4;t++)t>this.params.star?this.ui["star"+t].skin="res/game/ic_star_result_gray_b.png":this.ui["star"+t].skin="res/game/ic_star_result_b.png";this.params.star>2&&(this.ui.restartbtn.visible=!1,this.ui.nextBtn.visible=!0),this.ui.musicname.text=this.params.music.name,this.ui.authname.text=this.params.music.author,this.ui.scorelabel.text=this.params.score+"分",this.ui.tip.text=a.tipArrays[this.params.star],this.ui.coinLabel.text="X"+this._rewardCoin},a.prototype.updateData=function(){GameDataManager.instance.uploadCloudData(),GameDataManager.instance.recordMusicById(this.params.music.id,{score:this.params.score,star:this.params.star,name:this.params.music.name})},a.prototype.updateScore=function(){GameDataManager.instance.uploadMusicCloudData(this.params.music.id,this.params.score)},a.prototype.chooseNextMusic=function(){var t=this.params.music,a=t.cid,e=GameDataManager.instance.getMuicList({id:a}),i=e.indexOf(t);if(i<e.length-1){var n=e[i+1];XFacade.instance.showModule(GameLoading,n)}else{var s=GameDataManager.instance.nextChapter(a);if(s){GameDataManager.instance.checkModeIslock(s.id).length>0&&xframe.XTip.showTip("coming soon---------------")}else xframe.XTip.showTip("coming soon---------------"),XEvent.instance.event(GameEvent.HOMECHAPTER)}},a.prototype.toastReleaseNextChapter=function(){var t=this;this.topToast.y=-60,this.ui.addChild(this.topToast),Laya.Tween.to(this.topToast,{y:0},500,Laya.Ease.linearIn,Laya.Handler.create(this,function(){setTimeout(function(){Laya.Tween.to(t.topToast,{y:-60},500,Laya.Ease.linearIn,Laya.Handler.create(t,function(){Laya.Tween.clearTween(t.topToast),t.ui.removeChild(t.topToast),t.topToast=null}))},2e3)}))},a.tipArrays=["加油哦","不错！","腻害了","棒极了"],a}(xframe.XMWindow);