var usercloudInfoKey="userdata",usercloudCardKey="usercard",usercloudRoleKey="userrole",GameDataManager=function(){function t(){this.roleLIst=[]}return Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardConfig",{get:function(){return{1:[531,254],2:[375,379],3:[375,379],4:[531,254],5:[519,446],6:[519,446],7:[443,171],8:[443,171]}},enumerable:!0,configurable:!0}),t.prototype.checkModeIslock=function(t){if(DataManager.hasData(t+"")){var e=DataManager.getData(t);if(e.lock.length>0){if(1==(n=e.lock[0])){i=e.lock[1];User.instace.star>=i&&(e.lock=[],this.recordModeById(t,e))}else if(2==n){var r=e.lock[1];e.invite>=r&&(e.lock=[],this.recordModeById(t,e))}}return e.lock}var a={invite:0,lock:[],star:0},o=this.modeList.find(function(e){return e.id==t});if(o&&o.lock.length>0){a.lock=o.lock;var n=a.lock[0];if(1==n){var i=a.lock[1];User.instace.star>=i&&(a.lock=[])}}return this.recordModeById(t,a),a.lock},t.prototype.recordModeById=function(t,e){DataManager.setData(t+"",e)},t.prototype.getModeRecordDataById=function(t){return DataManager.getData(t+"")},t.prototype.recordMusicById=function(t,e){DataManager.setData("musicData"+t,e)},t.prototype.recordUserGameData=function(){DataManager.setData(usercloudInfoKey,User.instace)},t.prototype.getUserGameData=function(){return DataManager.getData(usercloudInfoKey)},t.prototype.recordUserCardsData=function(t){if(t){var e=(new Date).getTime(),r=Object.assign({timeTemp:e},t);User.instace.cards.unshift(r),DataManager.setData(usercloudCardKey,User.instace.cards)}},t.prototype.getUserCardsData=function(){return DataManager.getData(usercloudCardKey)},t.prototype.recordUserRolesData=function(t){t&&(User.instace.roles.push(t),DataManager.setData(usercloudRoleKey,User.instace.roles))},t.prototype.getUserRolesData=function(){return DataManager.getData(usercloudRoleKey)},t.prototype.nearestPlayChapterIndex=function(){return 0},t.prototype.recordNearestMusic=function(t,e){DataManager.setData("chapter"+t,e)},t.prototype.nearestPlayMusic=function(t){var e=this.getMuicList(t),r=e.find(function(t){return""==t.id});return r||e[0]},t.prototype.uploadCloudData=function(){var t={wxgame:{score:User.instace.star,update:0}};Tape.MiniRank.setRankData([{key:"star_score",value:JSON.stringify(t)}])},t.prototype.uploadMusicCloudData=function(t,e){var r={wxgame:{score:e,update:0}};Tape.MiniRank.setRankData([{key:"music_"+t,value:JSON.stringify(r)}])},t.prototype.updateMusicGrade=function(t,e){yxmp.api.setRankScore(t,{},"music"+e)},t.prototype.getMusicRankList=function(t){return yxmp.api.getRankList(100,"music"+t)},t.prototype.getMuicList=function(t){return Laya.loader.getRes("res/cfg/stage.json").filter(function(e){return e.cid==t.id})},t.prototype.rewardCoinByStar=function(t){var e=[[2,3],[6,7],[8,9],[12,13]];if(t<e.length){return e[t][Math.round(Math.random())]}return 0},t.prototype.chapterStarProgress=function(t){var e=this,r=0,a=0,o=this.modeList.find(function(e){return e.id==t});if(o){this.getMuicList(o).forEach(function(t,o){a+=3;var n=e.getRecordMusic(t.id);n&&(r+=n.star)})}return[r,a]},t.prototype.chapterAutoRelease=function(t,e){var r=this.nextChapter(t);if(r){var a=r.lock,o=a[0],n=a[1];if(1==o&&n>0){var i=this.getModeRecordDataById(r.id);if(!i||i.lock.length>0){User.instace.star>=n&&e&&e()}}}},t.prototype.getChapterById=function(t){return this.modeList.find(function(e){return e.id==t})},t.prototype.nextChapter=function(t){var e=this.getChapterById(t),r=this.modeList.indexOf(e);if(r>=this.modeList.length-1)return null;return this.modeList[r+1]},t.prototype.currentUsedRoleId=function(){return Laya.LocalStorage.getItem(usedRoleKey)},t.prototype.currentUserRoleImg=function(){var t=this.currentUsedRoleId(),e=this.roleLIst.find(function(e){return e.id==t});return e?"res/ic_role/"+e.img+".png":""},Object.defineProperty(t.prototype,"modeList",{get:function(){return this._modeList||(this._modeList=Laya.loader.getRes("res/cfg/game.json"),this._modeList=this._modeList.list),this._modeList},enumerable:!0,configurable:!0}),t}();